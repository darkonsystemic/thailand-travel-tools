<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Thailand Route Planner</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      background: #000000;
      min-height: 100vh;
    }
    .route-planner {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      max-width: 1000px;
      margin: 0 auto;
      padding: 2rem;
      background: #000000;
    }
    .planner-header {
      text-align: center;
      margin-bottom: 2rem;
    }
    .planner-header h1 {
      font-size: 2rem;
      color: #ffffff;
      margin-bottom: 0.5rem;
    }
    .planner-header p {
      color: #9ca3af;
      font-size: 1.1rem;
    }
    /* Route Builder */
    .route-builder {
      background: #ffffff;
      border-radius: 1rem;
      padding: 2rem;
      margin-bottom: 2rem;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
    }
    .route-row {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1rem;
      flex-wrap: wrap;
    }
    .route-row label {
      font-weight: 600;
      color: #1a1a1a;
      min-width: 80px;
    }
    .route-row select {
      flex: 1;
      min-width: 200px;
      padding: 0.75rem 1rem;
      font-size: 1rem;
      border: 2px solid #e2e8f0;
      border-radius: 0.5rem;
      background: #ffffff;
      color: #1a1a1a;
      cursor: pointer;
      transition: border-color 0.2s;
    }
    .route-row select:focus {
      outline: none;
      border-color: #C9A961;
    }
    /* Priority Selector */
    .priority-section {
      margin-top: 1.5rem;
      padding-top: 1.5rem;
      border-top: 1px solid #e2e8f0;
    }
    .priority-label {
      font-weight: 600;
      color: #1a1a1a;
      margin-bottom: 0.75rem;
      display: block;
    }
    .priority-options {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
    }
    .priority-btn {
      padding: 0.6rem 1.2rem;
      border: 2px solid #e2e8f0;
      border-radius: 2rem;
      background: #ffffff;
      cursor: pointer;
      font-size: 0.95rem;
      font-weight: 500;
      color: #4a5568;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 0.4rem;
    }
    .priority-btn:hover {
      border-color: #C9A961;
    }
    .priority-btn.active {
      border-color: #C9A961;
      background: #C9A961;
      color: #000000;
    }
    .priority-btn .icon {
      font-size: 1.1rem;
    }
    /* Stops Container */
    .stops-container {
      margin: 0.5rem 0 1rem 0;
    }
    .stop-row {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 0.5rem;
      padding-left: 80px;
    }
    .stop-row select {
      flex: 1;
      padding: 0.65rem 0.9rem;
      font-size: 0.95rem;
      border: 2px solid #e2e8f0;
      border-radius: 0.5rem;
      background: #ffffff;
      color: #1a1a1a;
      cursor: pointer;
    }
    .stop-row select:focus {
      outline: none;
      border-color: #C9A961;
    }
    .remove-stop-btn {
      background: #fee2e2;
      color: #dc2626;
      border: none;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 1.2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s;
      flex-shrink: 0;
    }
    .remove-stop-btn:hover {
      background: #fecaca;
    }
    .add-stop-btn {
      background: #ffffff;
      color: #C9A961;
      border: 2px dashed #C9A961;
      padding: 0.6rem 1.2rem;
      border-radius: 0.5rem;
      cursor: pointer;
      font-size: 0.9rem;
      font-weight: 500;
      margin-left: 80px;
      margin-bottom: 1rem;
      transition: all 0.2s;
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
    }
    .add-stop-btn:hover {
      background: #bbf7d0;
      border-style: solid;
    }
    .stop-label {
      font-size: 0.85rem;
      color: #64748b;
      min-width: 70px;
      text-align: right;
      padding-right: 10px;
    }
    .plan-btn {
      background: #C9A961;
      color: white;
      border: none;
      padding: 1rem 2rem;
      font-size: 1.1rem;
      font-weight: 600;
      border-radius: 0.5rem;
      cursor: pointer;
      margin-top: 1.5rem;
      width: 100%;
      transition: background 0.2s;
    }
    .plan-btn:hover {
      background: #a88a4a;
    }
    /* Results Section */
    .results-section {
      background: #1a1a1a;
      border: 1px solid #333;
      border-radius: 1rem;
      overflow: hidden;
      margin-bottom: 2rem;
    }
    .results-header {
      background: #C9A961;
      color: #000000;
      padding: 1rem 1.5rem;
      font-weight: 600;
      font-size: 1.1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .route-type-badge {
      background: rgba(0,0,0,0.2);
      padding: 0.3rem 0.8rem;
      border-radius: 1rem;
      font-size: 0.85rem;
    }
    .results-body {
      padding: 1.5rem;
    }
    /* Journey Step */
    .journey-step {
      display: flex;
      margin-bottom: 1.5rem;
      position: relative;
    }
    .journey-step:last-child {
      margin-bottom: 0;
    }
    .step-timeline {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-right: 1rem;
      min-width: 40px;
    }
    .step-number {
      width: 36px;
      height: 36px;
      background: #C9A961;
      color: #000000;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 0.9rem;
      flex-shrink: 0;
    }
    .step-line {
      width: 3px;
      flex: 1;
      background: #444;
      margin-top: 0.5rem;
    }
    .journey-step:last-child .step-line {
      display: none;
    }
    .step-content {
      flex: 1;
      background: #2a2a2a;
      border-radius: 0.75rem;
      padding: 1rem 1.25rem;
      border: 1px solid #444;
    }
    .step-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 0.5rem;
      flex-wrap: wrap;
      gap: 0.5rem;
    }
    .step-route {
      font-weight: 600;
      color: #ffffff;
      font-size: 1.05rem;
    }
    .step-mode {
      display: inline-flex;
      align-items: center;
      gap: 0.3rem;
      background: #333;
      color: #C9A961;
      padding: 0.25rem 0.6rem;
      border-radius: 0.25rem;
      font-size: 0.85rem;
      font-weight: 500;
      border: 1px solid #C9A961;
    }
    .step-details {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin-top: 0.75rem;
      font-size: 0.9rem;
      color: #9ca3af;
    }
    .step-detail {
      display: flex;
      align-items: center;
      gap: 0.3rem;
    }
    .step-detail .icon {
      font-size: 1rem;
    }
    .step-instructions {
      margin-top: 0.75rem;
      padding-top: 0.75rem;
      border-top: 1px dashed #444;
      font-size: 0.9rem;
      color: #9ca3af;
      line-height: 1.5;
    }
    .step-tip {
      background: #2a2a1a;
      color: #C9A961;
      padding: 0.5rem 0.75rem;
      border-radius: 0.375rem;
      margin-top: 0.75rem;
      font-size: 0.85rem;
      display: flex;
      align-items: flex-start;
      gap: 0.4rem;
      border: 1px solid #C9A961;
    }
    .step-tip .icon {
      flex-shrink: 0;
    }
    /* Route Summary */
    .route-summary {
      background: linear-gradient(135deg, #C9A961 0%, #a88a4a 100%);
      padding: 1.5rem;
      display: flex;
      justify-content: space-around;
      flex-wrap: wrap;
      gap: 1rem;
    }
    .summary-item {
      text-align: center;
      color: white;
    }
    .summary-value {
      font-size: 1.75rem;
      font-weight: bold;
    }
    .summary-label {
      font-size: 0.85rem;
      opacity: 0.9;
    }
    /* Alternative Routes */
    .alternatives-section {
      margin-top: 2rem;
    }
    .alternatives-header {
      font-size: 1.1rem;
      font-weight: 600;
      color: #ffffff;
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .alternative-card {
      background: #1a1a1a;
      border: 1px solid #333;
      border-radius: 0.75rem;
      padding: 1rem 1.25rem;
      margin-bottom: 1rem;
      cursor: pointer;
      transition: all 0.2s;
    }
    .alternative-card:hover {
      border-color: #C9A961;
      box-shadow: 0 4px 12px rgba(201, 169, 97, 0.15);
    }
    .alternative-card.active {
      border-color: #C9A961;
      background: #2a2a1a;
    }
    .alt-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.5rem;
    }
    .alt-type {
      font-weight: 600;
      color: #ffffff;
      display: flex;
      align-items: center;
      gap: 0.4rem;
    }
    .alt-stats {
      display: flex;
      gap: 1rem;
      font-size: 0.9rem;
      color: #9ca3af;
    }
    .alt-route-preview {
      font-size: 0.85rem;
      color: #9ca3af;
      margin-top: 0.5rem;
    }
    /* Map Section */
    .map-section {
      text-align: center;
      margin-top: 2rem;
    }
    .map-container {
      background: #b3d9ff;
      border-radius: 1rem;
      padding: 1rem;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
    }
    .map-wrapper {
      position: relative;
      width: 600px;
      aspect-ratio: 6 / 5;
      background-size: cover;
      background-position: center;
      border-radius: 0.5rem;
      overflow: hidden;
    }
    .map-svg {
      width: 100%;
      height: 100%;
      display: block;
    }
    .route-line {
      fill: none;
      stroke: #000000;
      stroke-width: 6;
      stroke-linecap: round;
      stroke-linejoin: round;
      stroke-dasharray: 1000;
      stroke-dashoffset: 1000;
      filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
    }
    .route-line.animate {
      animation: drawLine 3s ease-out forwards;
    }
    @keyframes drawLine {
      to {
        stroke-dashoffset: 0;
      }
    }
    .location-dot {
      fill: #dc2626;
      filter: drop-shadow(0 2px 4px rgba(0,0,0,0.4));
    }
    .location-dot.visited {
      fill: #dc2626;
    }
    .location-dot.current {
      fill: #dc2626;
      animation: pulse 1s ease-in-out infinite;
    }
    @keyframes pulse {
      0%, 100% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.3); opacity: 0.8; }
    }
    .location-label-bg {
      fill: #ffffff;
      opacity: 0.85;
      rx: 4;
      ry: 4;
    }
    .location-label {
      font-size: 11px;
      font-weight: 700;
      fill: #1e293b;
      text-anchor: middle;
      filter: drop-shadow(0 1px 2px rgba(255,255,255,0.8));
    }
    .moving-dot {
      fill: #dc2626;
      filter: drop-shadow(0 2px 6px rgba(220, 38, 38, 0.6));
    }
    .map-placeholder {
      color: #3b82f6;
      font-size: 1rem;
      text-align: center;
      padding: 2rem;
    }
    .map-caption {
      margin-top: 0.75rem;
      font-size: 0.9rem;
      color: #9ca3af;
    }
    .map-legend {
      display: flex;
      justify-content: center;
      gap: 1.5rem;
      margin-top: 0.75rem;
      font-size: 0.85rem;
      color: #9ca3af;
    }
    .legend-item {
      display: flex;
      align-items: center;
      gap: 0.4rem;
    }
    .legend-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
    }
    .legend-dot.start { background: #dc2626; }
    .legend-dot.visited { background: #16a34a; }
    /* Responsive map */
    @media (max-width: 650px) {
      .map-wrapper {
        width: 100%;
        aspect-ratio: 6 / 5;
      }
    }
    /* No route message */
    .no-route {
      text-align: center;
      padding: 3rem 2rem;
      color: #64748b;
    }
    .no-route .icon {
      font-size: 3rem;
      margin-bottom: 1rem;
    }
    /* Responsive */
    @media (max-width: 600px) {
      .route-row {
        flex-direction: column;
        align-items: stretch;
      }
      .route-row label {
        min-width: auto;
      }
      .stop-row {
        padding-left: 0;
        flex-wrap: wrap;
      }
      .stop-label {
        min-width: 100%;
        text-align: left;
        padding-right: 0;
        margin-bottom: 0.25rem;
      }
      .add-stop-btn {
        margin-left: 0;
      }
      .step-header {
        flex-direction: column;
      }
      .route-summary {
        padding: 1rem;
      }
      .summary-value {
        font-size: 1.4rem;
      }
    }
  </style>
</head>
<body>
  <div class="route-planner">
    <!-- Header -->
    <div class="planner-header">
      <h1>üáπüá≠ Thailand Route Planner</h1>
      <p>Plan your journey across Thailand - we'll figure out all the connections for you!</p>
    </div>
    <!-- Route Builder -->
    <div class="route-builder">
      <div class="route-row">
        <label>From:</label>
        <select id="start-select">
          <option value="">Select starting point...</option>
          <optgroup label="Central">
            <option value="bangkok">Bangkok</option>
          </optgroup>
          <optgroup label="North">
            <option value="chiangmai">Chiang Mai</option>
            <option value="chiangrai">Chiang Rai</option>
            <option value="pai">Pai</option>
          </optgroup>
          <optgroup label="East Coast">
            <option value="pattaya">Pattaya</option>
            <option value="trat">Trat</option>
            <option value="kohchang">Koh Chang</option>
            <option value="kohkood">Koh Kood</option>
          </optgroup>
          <optgroup label="Gulf Islands">
            <option value="suratthani">Surat Thani</option>
            <option value="samui">Koh Samui</option>
            <option value="kohphangan">Koh Phangan</option>
            <option value="kohtao">Koh Tao</option>
          </optgroup>
          <optgroup label="Andaman Coast">
            <option value="phuket">Phuket</option>
            <option value="krabi">Krabi</option>
            <option value="phiphi">Koh Phi Phi</option>
            <option value="kohlanta">Koh Lanta</option>
            <option value="kohyaoyai">Koh Yao Yai</option>
            <option value="kohmook">Koh Mook</option>
            <option value="kohlipe">Koh Lipe</option>
          </optgroup>
        </select>
      </div>
      <!-- Stops Container -->
      <div class="stops-container" id="stops-container">
        <!-- Dynamic stops will be added here -->
      </div>
      <button class="add-stop-btn" id="add-stop-btn">
        <span>+</span> Add a stop
      </button>
      <div class="route-row">
        <label>To:</label>
        <select id="end-select">
          <option value="">Select destination...</option>
          <optgroup label="Central">
            <option value="bangkok">Bangkok</option>
          </optgroup>
          <optgroup label="North">
            <option value="chiangmai">Chiang Mai</option>
            <option value="chiangrai">Chiang Rai</option>
            <option value="pai">Pai</option>
          </optgroup>
          <optgroup label="East Coast">
            <option value="pattaya">Pattaya</option>
            <option value="trat">Trat</option>
            <option value="kohchang">Koh Chang</option>
            <option value="kohkood">Koh Kood</option>
          </optgroup>
          <optgroup label="Gulf Islands">
            <option value="suratthani">Surat Thani</option>
            <option value="samui">Koh Samui</option>
            <option value="kohphangan">Koh Phangan</option>
            <option value="kohtao">Koh Tao</option>
          </optgroup>
          <optgroup label="Andaman Coast">
            <option value="phuket">Phuket</option>
            <option value="krabi">Krabi</option>
            <option value="phiphi">Koh Phi Phi</option>
            <option value="kohlanta">Koh Lanta</option>
            <option value="kohyaoyai">Koh Yao Yai</option>
            <option value="kohmook">Koh Mook</option>
            <option value="kohlipe">Koh Lipe</option>
          </optgroup>
        </select>
      </div>
      <div class="priority-section">
        <span class="priority-label">What matters most to you?</span>
        <div class="priority-options">
          <button class="priority-btn active" data-priority="speed">
            <span class="icon">‚ö°</span> Fastest
          </button>
          <button class="priority-btn" data-priority="cost">
            <span class="icon">üí∞</span> Cheapest
          </button>
          <button class="priority-btn" data-priority="comfort">
            <span class="icon">üõãÔ∏è</span> Most Comfortable
          </button>
        </div>
      </div>
      <button class="plan-btn" id="plan-btn">Plan My Journey</button>
    </div>
    <!-- Results -->
    <div id="results-container"></div>
    <!-- Map -->
    <div class="map-section" id="map-section">
      <div class="map-container">
        <div class="map-wrapper" id="map-wrapper">
          <svg class="map-svg" id="map-svg" viewBox="0 0 600 500" preserveAspectRatio="xMidYMid meet" style="width:100%;height:100%;display:block;">
            <image href="https://darkonlondon.com/wp-content/uploads/2026/02/ChatGPT-Image-Feb-7-2026-08_31_32-PM.png" x="0" y="0" width="600" height="500" preserveAspectRatio="none" />
            <g id="route-lines"></g>
            <g id="location-dots"></g>
            <circle id="moving-dot" class="moving-dot" r="8" style="display: none;"></circle>
          </svg>
        </div>
      </div>
      <div class="map-legend">
        <div class="legend-item"><div class="legend-dot start"></div> Route</div>
        <div class="legend-item"><div class="legend-dot visited"></div> Visited</div>
      </div>
      <p class="map-caption">Your route across Thailand</p>
    </div>
  </div>
  <script>
    (function() {
      // ===== DESTINATION DATA =====
      const destinations = {
        bangkok: { name: 'Bangkok', region: 'Central', type: 'hub', hasAirport: true, hasTrainStation: true },
        chiangmai: { name: 'Chiang Mai', region: 'North', type: 'hub', hasAirport: true, hasTrainStation: true },
        chiangrai: { name: 'Chiang Rai', region: 'North', type: 'city', hasAirport: true },
        pai: { name: 'Pai', region: 'North', type: 'town' },
        pattaya: { name: 'Pattaya', region: 'East', type: 'city' },
        trat: { name: 'Trat', region: 'East', type: 'hub', hasAirport: true },
        kohchang: { name: 'Koh Chang', region: 'East', type: 'island' },
        kohkood: { name: 'Koh Kood', region: 'East', type: 'island' },
        suratthani: { name: 'Surat Thani', region: 'Gulf', type: 'hub', hasAirport: true, hasTrainStation: true },
        samui: { name: 'Koh Samui', region: 'Gulf', type: 'island', hasAirport: true },
        kohphangan: { name: 'Koh Phangan', region: 'Gulf', type: 'island' },
        kohtao: { name: 'Koh Tao', region: 'Gulf', type: 'island' },
        phuket: { name: 'Phuket', region: 'Andaman', type: 'hub', hasAirport: true },
        krabi: { name: 'Krabi', region: 'Andaman', type: 'hub', hasAirport: true },
        phiphi: { name: 'Koh Phi Phi', region: 'Andaman', type: 'island' },
        kohlanta: { name: 'Koh Lanta', region: 'Andaman', type: 'island' },
        kohyaoyai: { name: 'Koh Yao Yai', region: 'Andaman', type: 'island' },
        kohmook: { name: 'Koh Mook', region: 'Andaman', type: 'island' },
        kohlipe: { name: 'Koh Lipe', region: 'Andaman', type: 'island' }
      };

      // ===== MAP COORDINATES =====
      const mapCoordinates = {
        chiangrai: { x: 216, y: 25 },
        chiangmai: { x: 216, y: 78 },
        pai: { x: 198, y: 42 },
        bangkok: { x: 268, y: 226 },
        pattaya: { x: 286, y: 242 },
        trat: { x: 315, y: 248 },
        kohchang: { x: 326, y: 276 },
        kohkood: { x: 332, y: 284 },
        suratthani: { x: 240, y: 369 },
        samui: { x: 251, y: 357 },
        kohphangan: { x: 254, y: 347 },
        kohtao: { x: 252, y: 334 },
        phuket: { x: 202, y: 406 },
        krabi: { x: 214, y: 390 },
        kohyaoyai: { x: 207, y: 396 },
        phiphi: { x: 215, y: 404 },
        kohlanta: { x: 225, y: 415 },
        kohmook: { x: 228, y: 422 },
        kohlipe: { x: 230, y: 447 }
      };

      // ===== COMPLETE TRANSPORT SEGMENTS =====
      const segments = [
        // ===== BANGKOK TO NORTH =====
        { from: 'bangkok', to: 'chiangmai', mode: 'flight', time: 75, cost: 35, comfort: 9, icon: '‚úàÔ∏è',
          instructions: 'Flights depart from Don Mueang (DMK). AirAsia, Nok Air, Lion Air, Thai VietJet all operate. Book early for $25-50 fares.' },
        { from: 'bangkok', to: 'chiangmai', mode: 'sleeper-train', time: 660, cost: 40, comfort: 8, icon: 'üöÇ',
          instructions: 'Overnight sleeper train from Krung Thep Aphiwat Central Terminal. 10-14 hour journey. Upper berth cheaper, lower berth more space.' },
        { from: 'bangkok', to: 'chiangmai', mode: 'bus', time: 600, cost: 25, comfort: 6, icon: 'üöå',
          instructions: 'VIP buses from Chatuchak Bus Terminal. 9.5-12 hours. NCA (Nakhonchai Air) is the best operator.' },
        { from: 'bangkok', to: 'chiangrai', mode: 'flight', time: 80, cost: 40, comfort: 9, icon: '‚úàÔ∏è',
          instructions: 'Flights from Don Mueang (DMK) to Mae Fah Luang Airport. AirAsia and Nok Air operate daily.' },
        { from: 'bangkok', to: 'chiangrai', mode: 'bus', time: 660, cost: 28, comfort: 6, icon: 'üöå',
          instructions: 'Overnight VIP bus from Chatuchak Bus Terminal. About 11 hours. Greenbus and NCA operate this route.' },

        // ===== NORTH INTERNAL =====
        { from: 'chiangmai', to: 'chiangrai', mode: 'bus', time: 180, cost: 8, comfort: 7, icon: 'üöå',
          instructions: 'Greenbus from Arcade Bus Station runs hourly. 3 hours via the new highway. VIP class recommended.' },
        { from: 'chiangmai', to: 'pai', mode: 'minivan', time: 210, cost: 6, comfort: 5, icon: 'üöê',
          instructions: 'Minivans from Arcade Bus Station. 3-4 hours, 762 CURVES! Take motion sickness tablets. Morning departures recommended.' },
        { from: 'chiangrai', to: 'pai', mode: 'bus', time: 300, cost: 10, comfort: 5, icon: 'üöå',
          instructions: 'No direct bus - take Chiang Rai to Chiang Mai bus, then transfer to Pai minivan. Or hire a private car.' },

        // ===== BANGKOK TO EAST COAST =====
        { from: 'bangkok', to: 'pattaya', mode: 'bus', time: 150, cost: 6, comfort: 6, icon: 'üöå',
          instructions: 'Buses leave from Ekkamai (Eastern) Bus Terminal every 30 minutes. Bell Travel Service also runs from Khao San Road.' },
        { from: 'bangkok', to: 'trat', mode: 'bus', time: 360, cost: 12, comfort: 6, icon: 'üöå',
          instructions: 'Bus 999 from Ekkamai departs 07:45 and 09:00 daily. 5-6 hours. Cherdchai Tour also operates this route.' },
        { from: 'bangkok', to: 'trat', mode: 'flight', time: 60, cost: 50, comfort: 9, icon: '‚úàÔ∏è',
          instructions: 'Bangkok Airways flies from Suvarnabhumi to Trat Airport. About 1 hour, but expensive.' },
        { from: 'pattaya', to: 'trat', mode: 'bus', time: 240, cost: 10, comfort: 6, icon: 'üöå',
          instructions: 'Direct bus from Pattaya Bus Station. About 4 hours along the coast road.' },

        // ===== EAST COAST ISLANDS =====
        { from: 'trat', to: 'kohchang', mode: 'ferry', time: 45, cost: 4, comfort: 7, icon: '‚õ¥Ô∏è',
          instructions: 'Ferries from Centerpoint Pier. Runs every 30-60 minutes from 6:30 AM to 7 PM. 45 min crossing.' },
        { from: 'trat', to: 'kohkood', mode: 'speedboat', time: 75, cost: 15, comfort: 6, icon: 'üö§',
          instructions: 'Speedboats from Laem Sok Pier. Boonsiri operates daily departures. About 1.5 hours.' },
        { from: 'kohchang', to: 'kohkood', mode: 'speedboat', time: 60, cost: 12, comfort: 6, icon: 'üö§',
          instructions: 'Boonsiri speedboat connects the islands. Seasonal schedule (Nov-May most reliable). About 1 hour.' },

        // ===== BANGKOK TO GULF =====
        { from: 'bangkok', to: 'suratthani', mode: 'flight', time: 70, cost: 35, comfort: 9, icon: '‚úàÔ∏è',
          instructions: 'Flights from Don Mueang or Suvarnabhumi. AirAsia, Nok Air, Thai Lion Air. About 1 hour 10 minutes.' },
        { from: 'bangkok', to: 'suratthani', mode: 'sleeper-train', time: 540, cost: 30, comfort: 7, icon: 'üöÇ',
          instructions: 'Overnight sleeper from Krung Thep Aphiwat Central Terminal. Departs evening, arrives early morning. 9 hours.' },
        { from: 'bangkok', to: 'suratthani', mode: 'bus', time: 540, cost: 20, comfort: 6, icon: 'üöå',
          instructions: 'VIP buses from Southern Bus Terminal (Sai Tai Mai). About 9 hours overnight. Phantip and Seatran operate.' },
        { from: 'bangkok', to: 'samui', mode: 'flight', time: 75, cost: 80, comfort: 9, icon: '‚úàÔ∏è',
          instructions: 'Bangkok Airways flies direct from Suvarnabhumi to Koh Samui. Pricey but convenient - 1 hour 15 min.' },

        // ===== GULF ISLAND CONNECTIONS =====
        { from: 'suratthani', to: 'samui', mode: 'ferry', time: 90, cost: 8, comfort: 7, icon: '‚õ¥Ô∏è',
          instructions: 'Seatran Discovery or Raja Ferry from Donsak Pier. Combined bus+ferry tickets available from Surat Thani town/airport.' },
        { from: 'suratthani', to: 'kohphangan', mode: 'ferry', time: 150, cost: 10, comfort: 7, icon: '‚õ¥Ô∏è',
          instructions: 'Raja Ferry or Seatran from Donsak Pier. Combined bus+ferry tickets include transfer from town/airport. About 2.5 hours.' },
        { from: 'suratthani', to: 'kohtao', mode: 'ferry', time: 360, cost: 18, comfort: 5, icon: '‚õ¥Ô∏è',
          instructions: 'Night ferry from Surat Thani port or daytime speedboat via Donsak. Lomprayah catamaran is fastest at ~3.5 hrs from Donsak.' },
        { from: 'samui', to: 'kohphangan', mode: 'ferry', time: 30, cost: 6, comfort: 8, icon: '‚õ¥Ô∏è',
          instructions: 'Lomprayah or Seatran from Nathon or Bangrak Pier. Runs multiple times daily. Just 20-30 minutes.' },
        { from: 'samui', to: 'kohtao', mode: 'ferry', time: 105, cost: 12, comfort: 7, icon: '‚õ¥Ô∏è',
          instructions: 'Lomprayah catamaran from Bangrak Pier. Stops at Koh Phangan en route. About 1.5-2 hours total.' },
        { from: 'kohphangan', to: 'kohtao', mode: 'ferry', time: 60, cost: 8, comfort: 7, icon: '‚õ¥Ô∏è',
          instructions: 'Lomprayah or Seatran catamaran. Multiple daily departures. About 1 hour.' },

        // ===== BANGKOK TO ANDAMAN =====
        { from: 'bangkok', to: 'phuket', mode: 'flight', time: 80, cost: 40, comfort: 9, icon: '‚úàÔ∏è',
          instructions: 'Multiple airlines from Don Mueang and Suvarnabhumi. AirAsia, Nok Air, Thai VietJet, Thai Lion Air. About 1.5 hours.' },
        { from: 'bangkok', to: 'phuket', mode: 'bus', time: 720, cost: 30, comfort: 5, icon: 'üöå',
          instructions: 'VIP overnight bus from Southern Bus Terminal. 12 hours. Take the VIP 24-seat bus for more comfort.' },
        { from: 'bangkok', to: 'krabi', mode: 'flight', time: 80, cost: 40, comfort: 9, icon: '‚úàÔ∏è',
          instructions: 'AirAsia and other low-cost carriers from Don Mueang. About 1 hour 20 minutes direct.' },
        { from: 'bangkok', to: 'krabi', mode: 'bus', time: 660, cost: 28, comfort: 5, icon: 'üöå',
          instructions: 'Overnight VIP bus from Southern Bus Terminal. About 11 hours. Transport Co. and Phantip operate.' },

        // ===== ANDAMAN CONNECTIONS =====
        { from: 'phuket', to: 'krabi', mode: 'minivan', time: 180, cost: 8, comfort: 6, icon: 'üöê',
          instructions: 'Shared minivans from Phuket Bus Terminal. About 3 hours via Phang Nga. Door-to-door service available.' },
        { from: 'phuket', to: 'phiphi', mode: 'ferry', time: 120, cost: 15, comfort: 7, icon: '‚õ¥Ô∏è',
          instructions: 'Ferries from Rassada Pier. Multiple operators daily (Andaman Wave Master, Phi Phi Cruiser). About 2 hours.' },
        { from: 'phuket', to: 'kohyaoyai', mode: 'ferry', time: 60, cost: 10, comfort: 7, icon: '‚õ¥Ô∏è',
          instructions: 'Speedboats from Bang Rong Pier (northeast Phuket). About 1 hour. Koh Yao Yai Ferry operates daily.' },
        { from: 'krabi', to: 'phiphi', mode: 'ferry', time: 90, cost: 12, comfort: 7, icon: '‚õ¥Ô∏è',
          instructions: 'Ferries from Klong Jilad Pier. Multiple departures 9 AM - 3 PM. About 1.5 hours.' },
        { from: 'krabi', to: 'kohlanta', mode: 'minivan-ferry', time: 120, cost: 10, comfort: 6, icon: 'üöê',
          instructions: 'Minivan from Krabi town to Koh Lanta. Includes 2 short ferry crossings. Total about 2 hours door to door.' },
        { from: 'krabi', to: 'kohyaoyai', mode: 'ferry', time: 75, cost: 12, comfort: 7, icon: '‚õ¥Ô∏è',
          instructions: 'Speedboat from Tha Lane Pier or Klong Jilad Pier. About 1 hour 15 minutes.' },
        { from: 'phiphi', to: 'kohlanta', mode: 'ferry', time: 60, cost: 10, comfort: 7, icon: '‚õ¥Ô∏è',
          instructions: 'Direct ferry between the islands. Operates in high season (Nov-Apr). About 1 hour.' },
        { from: 'phiphi', to: 'phuket', mode: 'ferry', time: 120, cost: 15, comfort: 7, icon: '‚õ¥Ô∏è',
          instructions: 'Return ferries to Rassada Pier. Multiple departures in the morning and afternoon.' },
        { from: 'kohlanta', to: 'kohmook', mode: 'ferry', time: 60, cost: 10, comfort: 6, icon: '‚õ¥Ô∏è',
          instructions: 'Speedboat or longtail from Saladan Pier. Part of the Trang island hopping route. About 1 hour.' },
        { from: 'kohlanta', to: 'kohlipe', mode: 'ferry', time: 240, cost: 25, comfort: 6, icon: '‚õ¥Ô∏è',
          instructions: 'Tigerline or Bundhaya Speed Boat. High season only (Nov-Apr). About 4 hours with possible stops.' },
        { from: 'kohmook', to: 'kohlipe', mode: 'ferry', time: 180, cost: 20, comfort: 6, icon: '‚õ¥Ô∏è',
          instructions: 'Speedboat via Trang island chain. Seasonal service. About 3 hours with island stops.' },
        { from: 'kohmook', to: 'kohlanta', mode: 'ferry', time: 60, cost: 10, comfort: 6, icon: '‚õ¥Ô∏è',
          instructions: 'Speedboat or longtail back to Koh Lanta. About 1 hour. Check seasonal availability.' },

        // ===== CROSS-REGION CONNECTIONS =====
        { from: 'suratthani', to: 'krabi', mode: 'bus', time: 180, cost: 8, comfort: 6, icon: 'üöå',
          instructions: 'Direct bus from Surat Thani Bus Terminal. About 3 hours. Phantip 1970 operates this route.' },
        { from: 'suratthani', to: 'phuket', mode: 'bus', time: 300, cost: 12, comfort: 6, icon: 'üöå',
          instructions: 'Bus from Surat Thani to Phuket Bus Terminal. About 5 hours. Phantip and local operators.' },
        { from: 'phuket', to: 'samui', mode: 'flight', time: 60, cost: 50, comfort: 9, icon: '‚úàÔ∏è',
          instructions: 'Bangkok Airways operates a direct flight. About 1 hour. Expensive but saves a full day of travel.' },
        { from: 'krabi', to: 'samui', mode: 'ferry-combo', time: 300, cost: 25, comfort: 6, icon: '‚õ¥Ô∏è',
          instructions: 'Combined bus + ferry via Surat Thani/Donsak. Lomprayah and Seatran offer joint tickets. About 5 hours total.' },
        { from: 'phuket', to: 'kohlipe', mode: 'ferry', time: 360, cost: 40, comfort: 6, icon: '‚õ¥Ô∏è',
          instructions: 'Seasonal high-speed ferry (Nov-Apr). Tigerline operates with stops at Phi Phi and Lanta. About 6 hours.' },
        { from: 'krabi', to: 'kohlipe', mode: 'ferry', time: 300, cost: 35, comfort: 6, icon: '‚õ¥Ô∏è',
          instructions: 'Tigerline or Bundhaya Speed Boat. High season (Nov-Apr). About 5 hours with island stops.' }
      ];

      // Make bidirectional
      const allSegments = [];
      segments.forEach(seg => {
        allSegments.push(seg);
        allSegments.push({ ...seg, from: seg.to, to: seg.from });
      });

      // ===== DIRECTION SCORING =====
      const locationRegions = {
        chiangmai: { region: 'north', lat: 18.8 },
        chiangrai: { region: 'north', lat: 19.9 },
        pai: { region: 'north', lat: 19.4 },
        bangkok: { region: 'central', lat: 13.8 },
        pattaya: { region: 'east', lat: 12.9 },
        trat: { region: 'east', lat: 12.2 },
        kohchang: { region: 'east', lat: 12.0 },
        kohkood: { region: 'east', lat: 11.6 },
        suratthani: { region: 'gulf', lat: 9.1 },
        samui: { region: 'gulf', lat: 9.5 },
        kohphangan: { region: 'gulf', lat: 9.7 },
        kohtao: { region: 'gulf', lat: 10.1 },
        phuket: { region: 'andaman', lat: 7.9 },
        krabi: { region: 'andaman', lat: 8.1 },
        kohyaoyai: { region: 'andaman', lat: 8.0 },
        phiphi: { region: 'andaman', lat: 7.7 },
        kohlanta: { region: 'andaman', lat: 7.5 },
        kohmook: { region: 'andaman', lat: 7.4 },
        kohlipe: { region: 'andaman', lat: 6.5 }
      };

      function isTowardDestination(from, to, finalDest) {
        const fromLoc = locationRegions[from];
        const toLoc = locationRegions[to];
        const destLoc = locationRegions[finalDest];
        if (!fromLoc || !toLoc || !destLoc) return 0;
        const distBefore = Math.abs(fromLoc.lat - destLoc.lat);
        const distAfter = Math.abs(toLoc.lat - destLoc.lat);
        const sameRegion = toLoc.region === destLoc.region;
        let score = distBefore - distAfter;
        if (sameRegion) score += 2;
        if (to === finalDest) score += 10;
        return score;
      }

      // ===== ROUTE FINDING =====
      function findAllRoutes(start, end, priority) {
        const routes = [];
        const visited = new Set();
        const maxDepth = 5;

        function dfs(current, path, totalTime, totalCost, comfortSum, comfortCount) {
          if (current === end) {
            routes.push({
              path: [...path],
              totalTime,
              totalCost,
              avgComfort: comfortSum / comfortCount,
              steps: path.length
            });
            return;
          }
          if (path.length >= maxDepth) return;

          const nextSegments = allSegments.filter(s => s.from === current && !visited.has(s.to));
          nextSegments.sort((a, b) => {
            const aToward = isTowardDestination(current, a.to, end);
            const bToward = isTowardDestination(current, b.to, end);
            if (aToward > 0 && bToward <= 0) return -1;
            if (bToward > 0 && aToward <= 0) return 1;
            if (priority === 'speed') return a.time - b.time;
            if (priority === 'cost') return a.cost - b.cost;
            return b.comfort - a.comfort;
          });

          for (const seg of nextSegments) {
            visited.add(seg.to);
            path.push(seg);
            dfs(seg.to, path, totalTime + seg.time, totalCost + seg.cost, comfortSum + seg.comfort, comfortCount + 1);
            path.pop();
            visited.delete(seg.to);
          }
        }

        visited.add(start);
        dfs(start, [], 0, 0, 0, 0);

        routes.forEach(route => {
          let baseScore;
          if (priority === 'speed') baseScore = route.totalTime + (route.steps * 30);
          else if (priority === 'cost') baseScore = route.totalCost + (route.steps * 2);
          else baseScore = (10 - route.avgComfort) * 100 + route.steps * 20;
          route.score = baseScore;
        });

        routes.sort((a, b) => a.score - b.score);
        return routes.slice(0, 3);
      }

      // ===== STATE =====
      let currentPriority = 'speed';
      let currentRoutes = [];
      let selectedRouteIndex = 0;
      let stops = [];

      // ===== HELPERS =====
      function formatTime(minutes) {
        if (minutes < 60) return minutes + 'm';
        var h = Math.floor(minutes / 60);
        var m = minutes % 60;
        if (m === 0) return h + 'h';
        return h + 'h ' + m + 'm';
      }

      function formatCost(cost) {
        return '$' + Math.round(cost);
      }

      // ===== MAP UPDATE =====
      function updateMap() {
        var route = currentRoutes[selectedRouteIndex];
        if (!route) return;

        var routeLinesGroup = document.getElementById('route-lines');
        var locationDotsGroup = document.getElementById('location-dots');
        var movingDot = document.getElementById('moving-dot');

        routeLinesGroup.innerHTML = '';
        locationDotsGroup.innerHTML = '';
        movingDot.style.display = 'none';

        var locationIds = [route.path[0].from];
        route.path.forEach(function(seg) {
          if (locationIds.indexOf(seg.to) === -1) {
            locationIds.push(seg.to);
          }
        });

        var pathPoints = [];
        locationIds.forEach(function(id) {
          if (mapCoordinates[id]) {
            pathPoints.push(mapCoordinates[id]);
          }
        });

        if (pathPoints.length < 2) return;

        var pathD = 'M ' + pathPoints[0].x + ' ' + pathPoints[0].y;
        for (var i = 1; i < pathPoints.length; i++) {
          pathD += ' L ' + pathPoints[i].x + ' ' + pathPoints[i].y;
        }

        var totalLength = 0;
        for (var i = 1; i < pathPoints.length; i++) {
          var dx = pathPoints[i].x - pathPoints[i-1].x;
          var dy = pathPoints[i].y - pathPoints[i-1].y;
          totalLength += Math.sqrt(dx * dx + dy * dy);
        }

        var routeLine = document.createElementNS('http://www.w3.org/2000/svg', 'path');
        routeLine.setAttribute('d', pathD);
        routeLine.setAttribute('class', 'route-line');
        routeLine.setAttribute('stroke-dasharray', totalLength);
        routeLine.setAttribute('stroke-dashoffset', totalLength);
        routeLinesGroup.appendChild(routeLine);

        locationIds.forEach(function(id, index) {
          var coord = mapCoordinates[id];
          if (!coord) return;
          var dest = destinations[id];

          var dot = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
          dot.setAttribute('cx', coord.x);
          dot.setAttribute('cy', coord.y);
          dot.setAttribute('r', index === 0 ? 10 : 8);
          dot.setAttribute('class', 'location-dot');
          dot.setAttribute('data-index', index);
          locationDotsGroup.appendChild(dot);

          var labelBg = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
          labelBg.setAttribute('x', coord.x - 28);
          labelBg.setAttribute('y', coord.y - 21);
          labelBg.setAttribute('width', 56);
          labelBg.setAttribute('height', 13);
          labelBg.setAttribute('class', 'location-label-bg');
          locationDotsGroup.appendChild(labelBg);

          var label = document.createElementNS('http://www.w3.org/2000/svg', 'text');
          label.setAttribute('x', coord.x);
          label.setAttribute('y', coord.y - 12);
          label.setAttribute('class', 'location-label');
          label.textContent = dest.name;
          locationDotsGroup.appendChild(label);
        });

        setTimeout(function() {
          routeLine.classList.add('animate');
        }, 100);
      }

      // ===== STOPS MANAGEMENT =====
      function createStopSelect() {
        var startSelect = document.getElementById('start-select');
        var options = startSelect.innerHTML;
        return options.replace('Select starting point...', 'Select a stop...');
      }

      function addStop() {
        var container = document.getElementById('stops-container');
        var stopIndex = container.children.length + 1;
        var row = document.createElement('div');
        row.className = 'stop-row';
        row.innerHTML = '<span class="stop-label">Stop ' + stopIndex + ':</span>' +
          '<select class="stop-select">' + createStopSelect() + '</select>' +
          '<button class="remove-stop-btn" title="Remove stop">&times;</button>';

        var removeBtn = row.querySelector('.remove-stop-btn');
        removeBtn.addEventListener('click', function() {
          row.remove();
          renumberStops();
        });

        container.appendChild(row);
      }

      function renumberStops() {
        var container = document.getElementById('stops-container');
        var rows = container.querySelectorAll('.stop-row');
        rows.forEach(function(row, i) {
          row.querySelector('.stop-label').textContent = 'Stop ' + (i + 1) + ':';
        });
      }

      function getStopValues() {
        var stopSelects = document.querySelectorAll('.stop-select');
        var values = [];
        stopSelects.forEach(function(sel) {
          if (sel.value) values.push(sel.value);
        });
        return values;
      }

      // ===== PLAN ROUTE =====
      function planRoute() {
        var start = document.getElementById('start-select').value;
        var end = document.getElementById('end-select').value;

        if (!start || !end) {
          alert('Please select both a starting point and destination!');
          return;
        }

        // Build waypoints: start -> stops -> end
        var stopValues = getStopValues();
        var waypoints = [start].concat(stopValues).concat([end]);

        // Find routes for each leg
        var allLegs = [];
        var totalTime = 0;
        var totalCost = 0;
        var routeFound = true;

        for (var i = 0; i < waypoints.length - 1; i++) {
          var legRoutes = findAllRoutes(waypoints[i], waypoints[i + 1], currentPriority);
          if (legRoutes.length === 0) {
            routeFound = false;
            break;
          }
          var bestLeg = legRoutes[0];
          bestLeg.path.forEach(function(seg) {
            allLegs.push(seg);
            totalTime += seg.time;
            totalCost += seg.cost;
          });
        }

        // Also find simple direct routes (no stops) for display
        if (stopValues.length === 0) {
          currentRoutes = findAllRoutes(start, end, currentPriority);
        } else if (routeFound) {
          currentRoutes = [{
            path: allLegs,
            totalTime: totalTime,
            totalCost: totalCost,
            avgComfort: 7,
            steps: allLegs.length,
            score: 0
          }];
        } else {
          currentRoutes = [];
        }

        selectedRouteIndex = 0;
        var container = document.getElementById('results-container');

        if (currentRoutes.length === 0) {
          container.innerHTML = '<div class="results-section"><div class="no-route"><div class="icon">üó∫Ô∏è</div><p>We couldn\'t find a route between these destinations.<br>Try different locations or remove some stops.</p></div></div>';
        } else {
          var html = '';
          currentRoutes.forEach(function(route, routeIdx) {
            var label = routeIdx === 0 ? 'Recommended Route' : 'Alternative ' + routeIdx;
            html += '<div class="results-section"><div class="results-header"><span>' + label + '</span><span class="route-type-badge">' + route.path.length + ' leg' + (route.path.length > 1 ? 's' : '') + '</span></div><div class="results-body">';

            route.path.forEach(function(seg, i) {
              html += '<div class="journey-step">' +
                '<div class="step-timeline"><div class="step-number">' + (i + 1) + '</div>' +
                (i < route.path.length - 1 ? '<div class="step-line"></div>' : '') +
                '</div><div class="step-content">' +
                '<div class="step-header"><span class="step-route">' + destinations[seg.from].name + ' ‚Üí ' + destinations[seg.to].name + '</span>' +
                '<span class="step-mode">' + seg.icon + ' ' + seg.mode + '</span></div>' +
                '<div class="step-details">' +
                '<span class="step-detail"><span class="icon">‚è±Ô∏è</span> ' + formatTime(seg.time) + '</span>' +
                '<span class="step-detail"><span class="icon">üíµ</span> ' + formatCost(seg.cost) + '</span>' +
                '</div>' +
                '<div class="step-instructions">' + seg.instructions + '</div>' +
                '</div></div>';
            });

            html += '</div><div class="route-summary">' +
              '<div class="summary-item"><div class="summary-value">' + formatTime(route.totalTime) + '</div><div class="summary-label">Total Time</div></div>' +
              '<div class="summary-item"><div class="summary-value">~' + formatCost(route.totalCost) + '</div><div class="summary-label">Est. Cost</div></div>' +
              '<div class="summary-item"><div class="summary-value">' + route.path.length + '</div><div class="summary-label">Leg' + (route.path.length > 1 ? 's' : '') + '</div></div>' +
              '</div></div>';
          });

          container.innerHTML = html;
        }

        document.getElementById('map-section').style.display = 'block';
        updateMap();
      }

      // ===== EVENT LISTENERS =====
      document.getElementById('plan-btn').addEventListener('click', planRoute);

      document.getElementById('start-select').addEventListener('change', function() {
        if (document.getElementById('end-select').value) planRoute();
      });

      document.getElementById('end-select').addEventListener('change', function() {
        if (document.getElementById('start-select').value) planRoute();
      });

      document.getElementById('add-stop-btn').addEventListener('click', addStop);

      // Priority buttons
      document.querySelectorAll('.priority-btn').forEach(function(btn) {
        btn.addEventListener('click', function() {
          document.querySelectorAll('.priority-btn').forEach(function(b) { b.classList.remove('active'); });
          btn.classList.add('active');
          currentPriority = btn.getAttribute('data-priority');
          if (document.getElementById('start-select').value && document.getElementById('end-select').value) {
            planRoute();
          }
        });
      });

    })();
  </script>
</body>
</html>
